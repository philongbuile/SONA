"use strict";
/*
 * Copyright 2021 IBM All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ecRawSignatureAsDer = exports.ecPrivateKeyAsRaw = void 0;
/* eslint-disable */
// @ts-nocheck
const asn1_js_1 = require("asn1.js");
const ECPrivateKey = (0, asn1_js_1.define)('ECPrivateKey', function () {
    this.seq().obj(this.key('version').int().def(1), this.key('privateKey').octstr(), this.key('parameters').explicit(0).objid().optional(), this.key('publicKey').explicit(1).bitstr().optional());
});
const ECSignature = (0, asn1_js_1.define)('ECSignature', function () {
    return this.seq().obj(this.key('r').int(), this.key('s').int());
});
function ecPrivateKeyAsRaw(privateKey) {
    const privateKeyPem = privateKey.export({ format: 'der', type: 'sec1' });
    const decodedDer = ECPrivateKey.decode(privateKeyPem, 'der');
    return {
        privateKey: decodedDer.privateKey,
        curveObjectId: decodedDer.parameters,
    };
}
exports.ecPrivateKeyAsRaw = ecPrivateKeyAsRaw;
function ecRawSignatureAsDer(r, s) {
    return ECSignature.encode({ r, s }, 'der');
}
exports.ecRawSignatureAsDer = ecRawSignatureAsDer;
//# sourceMappingURL=asn1.js.map